Vagrant.configure("2") do |config|
  config.vm.box = "debian/bullseye64"
  config.vm.provision "install dependencies", type: "shell", inline: <<-SHELL
    apt-get update
    apt-get install -y wget expect gpg asciinema
  SHELL
  config.vm.provision "record install", type: "shell", inline: <<-SHELL
  	gpg --recv-keys "6D5B EF9A DD20 7580 5747 B70F 9F88 FB52 FAF7 B393"
    asciinema rec -c 'expect /vagrant/install.tcl' --overwrite /vagrant/install.json
  SHELL
  config.vm.provision "record basic usage", type: "shell", inline: <<-SHELL
  	rm -r /media/backup/borgdemo || true
    mkdir -p /media/backup/borgdemo
    asciinema rec -c 'expect /vagrant/basic.tcl' --overwrite /vagrant/basic.json
  SHELL
end
